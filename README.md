



# UDP сервис обработки катировок и получения elvl (energy level) по инструментам (ценным бумагам)

## Проектная работа для курса ["Java Developer. Professional"](https://otus.ru/lessons/java-professional/?utm_source=github&utm_medium=free&utm_campaign=otus)

### Разработчик
Aleksandr Semykin (Александр Семыкин)<br>
Группа 2021-09

### Руководитель
Сергей Петрелевич<br>

### ТЗ

Написать сервис для сохранения котировок и получения elvl по
инструментам (бумагам) по UDP.

Функциональные требования:
* Сервис получает котировки
* Сервис хранит историю полученных котировок в БД
* Сервис рассчитывает elvl (правила ниже)
* Сервис предоставляет elvl по isin
* Сервис предоставляет перечень всех elvls

Предусмотреть обработку большого потока котировок (100 в секунду) по нескольким бумагам, в том числе и
одновременную обработку нескольких котировок по одной бумаге.

Сущности:
* Котировка (quote) состоит из следующих полей:
  * isin- идентификатор ценной бумаги
  * bid- цена, которую готов заплатить покупатель
  * ask- цена, по которой продавец готов продать
* elvl (energy level) – лучшая цена по данному инструменту (isin).

Правила расчёта elvl на основе котировки:
1. Если bid > elvl, то elvl = bid
2. Если ask < elvl, то elvl = ask
3. Если значение elvl для данной бумаги отсутствует, то elvl = bid
4. Если bid отсутствует, то elvl = ask
   
Реализовать простую валидацию входных данных для котировки:
* bid должен быть меньше ask 
* isin – 12 символов

С помощью тестов продемонстрируйте, что функционал работает так, как ожидается.

### Состав проекта

### udp-quotes-generator
Генератор UDP датаграмм с катировками (NIO).
С некоторой частотой генерирует датаграммы
Предназначен для эмуляции работы биржи и тестирования основного проекта `upd-quotes-manager`

### todo
1. :white_check_mark: UDP генератор катировок.
2. spring-starter для подключения к генератору. **Под вопросом.**
3. UDP сервис обработки катировок 
   1. В сервисе сделать мапу Map<String, Double>: isin против elvl
   2. Сервис читает датаграмму. Парсит катировки в список dto. 
   3. Группирует их по isin. 
   4. Каждая группа сабмитится в пул потоков. В Callable<Double> таске для каждой катировки из группы перерасчитывается elvl по правилам из ТЗ и кладётся в мапу. 
   5. В другой пул потоков сабмитится этот же список дто для сохранения в БД. БД-постгрес.
   6. thymeleaf страница для отображения списка катировок с elvl и обновления их в реалтайме (ну или близком к нему насколько получится). Если пришла elvl выше текущей, то подсвечивать зелёным, иначе - красным.
